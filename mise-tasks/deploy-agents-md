#!/usr/bin/env fish
#MISE description = "Links global Claude, Codex, and OpenCode instructions to `./build/AGENTS.md`"

mise run build-agents-md
echo

set SOURCE $MISE_PROJECT_ROOT/build/AGENTS.md
set TARGETS ~/.claude/CLAUDE.md \
    ~/.codex/AGENTS.md \
    ~/.config/opencode/AGENTS.md

echo "About to symlink $SOURCE to …"
for TARGET in $TARGETS
    echo "- $TARGET"
end

gum confirm "Continue?" --default=No || exit 1

for TARGET in $TARGETS
    echo "- Linking to $TARGET …"
    ln -sf $SOURCE $TARGET
end

echo "✅ Done!"
